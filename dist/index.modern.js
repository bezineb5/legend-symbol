import{expression as t,function as e,latest as i}from"@mapbox/mapbox-gl-style-spec";function r(t){const{expr:e,layer:i}=t,r=Math.min(e(i,"paint","circle-radius"),8),n=Math.min(e(i,"paint","circle-stroke-width"),4),a=e(i,"paint","circle-color"),l=e(i,"paint","circle-opacity"),o=e(i,"paint","circle-stroke-color"),c=e(i,"paint","circle-stroke-opacity"),s=r-n/2;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",style:{filter:`blur(${e(i,"paint","circle-blur")*s}px)`}},children:[{element:"circle",attributes:{key:"l1",cx:10,cy:10,fill:a,opacity:l,r:s}},{element:"circle",attributes:{key:"l2",cx:10,cy:10,fill:"transparent",opacity:c,r,"stroke-width":n,stroke:o}}]}}function n(t){const{image:e,expr:i,layer:r}=t;return{element:"div",attributes:{style:{width:"100%",height:"100%",backgroundImage:`url(${e(i(r,"paint","fill-pattern"))})`,backgroundColor:i(r,"paint","fill-color"),opacity:i(r,"paint","fill-opacity"),backgroundSize:"66% 66%",backgroundPosition:"center"}}}}function a(t){const{layer:e,image:i,expr:r}=t,n=i(r(e,"paint","line-pattern")),a={stroke:n?"url(#img1)":r(e,"paint","line-color"),strokeWidth:Math.max(2,Math.min(r(e,"paint","line-width"),8)),strokeOpacity:r(e,"paint","line-opacity")},l=a.strokeWidth;return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"defs",attributes:{key:"defs"},children:[{element:"pattern",attributes:{key:"pattern",id:"img1",x:0,y:0,width:a.strokeWidth,height:a.strokeWidth,patternUnits:"userSpaceOnUse",patternTransform:`translate(${-l/2} ${-l/2}) rotate(45)`},children:[{element:"image",attributes:{key:"img",xlinkHref:n,x:0,y:0,width:a.strokeWidth,height:a.strokeWidth}}]}]},{element:"path",attributes:{key:"path",style:a,stroke:a.stroke,d:"M0 20 L 20 0"}}]}}function l(t){return function({expr:t,layer:e,image:i}){const r=t(e,"layout","icon-image");if(!r)return null;const n=i(r);return n?{element:"div",attributes:{style:{backgroundImage:`url(${n})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%"}}}:null}(t)||function({expr:t,layer:e}){const i=t(e,"paint","text-color"),r=t(e,"paint","text-opacity"),n="M 4,4 L 16,4 L 16,7 L 11.5 7 L 11.5 16 L 8.5 16 L 8.5 7 L 4 7 Z";return{element:"svg",attributes:{viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},children:[{element:"path",attributes:{key:"l1",d:n,stroke:t(e,"paint","text-halo-color"),"stroke-width":2*t(e,"paint","text-halo-width"),fill:"transparent","stroke-linejoin":"round"}},{element:"path",attributes:{key:"l2",d:n,fill:"white"}},{element:"path",attributes:{key:"l3",d:n,fill:i,opacity:r}}]}}(t)}const o=[["background"],["circle"],["fill-extrusion"],["fill"],["heatmap"],["hillshade"],["line"],["raster"],["icon","symbol"],["text","symbol"]];export default function({sprite:c,zoom:s,layer:u}){const p={circle:r,symbol:l,line:a,fill:n}[u.type],h=function({zoom:r}){return function(n,a,l){const c=function(t){const e=o.find(e=>t.startsWith(e[0]));return e?e[1]||e[0]:null}(l),s=i[`${a}_${c}`][l];if(!n[a])return s.default;const u=n[a][l];if(void 0===u)return s.default;if("object"==typeof u){let i;if(i=Array.isArray(u)?t.createExpression(u).value:e.createFunction(u,s),!i.evaluate)return null;const n=i.evaluate({zoom:r},{});return n?n.name||n:null}return u}}({zoom:s});return p?p({layer:u,expr:h,image:t=>{if(c&&c.json){const e=c.json[t];if(e)return function(t,{x:e,y:i,width:r,height:n}){const a=document.createElement("canvas");return a.width=2*r,a.height=2*n,a.getContext("2d").drawImage(t,2*e,2*i,2*r,2*n,0,0,2*r,2*n),a.toDataURL()}(c.image,e)}return null}}):null}
//# sourceMappingURL=index.modern.js.map
